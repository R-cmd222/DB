C:\Users\sdjf\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:318: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [66856]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9527 (Press CTRL+C to quit)
INFO:     None:0 - "GET /health HTTP/1.1" 200 OK
2025-06-24 16:17:08,489 INFO sqlalchemy.engine.Engine SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
INFO:sqlalchemy.engine.Engine:SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-24 16:17:08,489 INFO sqlalchemy.engine.Engine [raw sql] ()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
2025-06-24 16:17:08,489 INFO sqlalchemy.engine.Engine SELECT schema_name()
INFO:sqlalchemy.engine.Engine:SELECT schema_name()
2025-06-24 16:17:08,489 INFO sqlalchemy.engine.Engine [generated in 0.00049s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00049s] ()
2025-06-24 16:17:08,505 INFO sqlalchemy.engine.Engine SELECT CAST('test max support' AS NVARCHAR(max))
INFO:sqlalchemy.engine.Engine:SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-24 16:17:08,505 INFO sqlalchemy.engine.Engine [generated in 0.00051s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00051s] ()
2025-06-24 16:17:08,505 INFO sqlalchemy.engine.Engine SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
INFO:sqlalchemy.engine.Engine:SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-24 16:17:08,505 INFO sqlalchemy.engine.Engine [generated in 0.00046s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00046s] ()
2025-06-24 16:17:08,563 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:08,563 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
2025-06-24 16:17:08,563 INFO sqlalchemy.engine.Engine [generated in 0.00055s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00055s] ()
2025-06-24 16:17:08,563 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
2025-06-24 16:17:08,563 INFO sqlalchemy.engine.Engine [generated in 0.00059s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00059s] ()
2025-06-24 16:17:08,578 INFO sqlalchemy.engine.Engine SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
2025-06-24 16:17:08,578 INFO sqlalchemy.engine.Engine [generated in 0.00053s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00053s] ()
2025-06-24 16:17:08,578 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
2025-06-24 16:17:08,578 INFO sqlalchemy.engine.Engine [generated in 0.00055s] (10,)
INFO:sqlalchemy.engine.Engine:[generated in 0.00055s] (10,)
INFO:     None:0 - "GET /stats HTTP/1.1" 200 OK
2025-06-24 16:17:08,578 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:17:08,907 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:08,907 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:08,907 INFO sqlalchemy.engine.Engine [generated in 0.00050s] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00050s] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
2025-06-24 16:17:08,918 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:08,918 INFO sqlalchemy.engine.Engine [cached since 0.004493s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 0.004493s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
2025-06-24 16:17:08,918 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 16:17:08,918 INFO sqlalchemy.engine.Engine [generated in 0.00049s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00049s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
2025-06-24 16:17:08,924 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:08,924 INFO sqlalchemy.engine.Engine [cached since 0.01026s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 0.01026s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:     None:0 - "GET /dashboard/sales HTTP/1.1" 200 OK
2025-06-24 16:17:08,924 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:17:09,175 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:09,175 INFO sqlalchemy.engine.Engine SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 16:17:09,175 INFO sqlalchemy.engine.Engine [generated in 0.00057s] ('已结账',)
INFO:sqlalchemy.engine.Engine:[generated in 0.00057s] ('已结账',)
INFO:     None:0 - "GET /dashboard/top-products?limit=5 HTTP/1.1" 200 OK
2025-06-24 16:17:09,191 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:     None:0 - "GET /health HTTP/1.1" 200 OK
2025-06-24 16:17:12,406 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:12,406 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
2025-06-24 16:17:12,406 INFO sqlalchemy.engine.Engine [cached since 3.839s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 3.839s ago] ()
2025-06-24 16:17:12,410 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
2025-06-24 16:17:12,410 INFO sqlalchemy.engine.Engine [cached since 3.837s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 3.837s ago] ()
2025-06-24 16:17:12,410 INFO sqlalchemy.engine.Engine SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
2025-06-24 16:17:12,414 INFO sqlalchemy.engine.Engine [cached since 3.834s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 3.834s ago] ()
2025-06-24 16:17:12,414 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
2025-06-24 16:17:12,414 INFO sqlalchemy.engine.Engine [cached since 3.832s ago] (10,)
INFO:sqlalchemy.engine.Engine:[cached since 3.832s ago] (10,)
INFO:     None:0 - "GET /stats HTTP/1.1" 200 OK
2025-06-24 16:17:12,418 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:17:12,731 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:12,731 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:12,731 INFO sqlalchemy.engine.Engine [cached since 3.819s ago] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 3.819s ago] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
2025-06-24 16:17:12,735 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:12,735 INFO sqlalchemy.engine.Engine [cached since 3.821s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 3.821s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
2025-06-24 16:17:12,739 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 16:17:12,739 INFO sqlalchemy.engine.Engine [cached since 3.817s ago] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 3.817s ago] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
2025-06-24 16:17:12,739 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 16:17:12,739 INFO sqlalchemy.engine.Engine [cached since 3.826s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 3.826s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:     None:0 - "GET /dashboard/sales HTTP/1.1" 200 OK
2025-06-24 16:17:12,743 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:17:12,985 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:17:12,989 INFO sqlalchemy.engine.Engine SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 16:17:12,989 INFO sqlalchemy.engine.Engine [cached since 3.803s ago] ('已结账',)
INFO:sqlalchemy.engine.Engine:[cached since 3.803s ago] ('已结账',)
INFO:     None:0 - "GET /dashboard/top-products?limit=5 HTTP/1.1" 200 OK
2025-06-24 16:17:12,989 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:19:28,426 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:19:28,427 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 16:19:28,428 INFO sqlalchemy.engine.Engine [generated in 0.00058s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00058s] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 16:19:28,434 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:__main__:正在获取订单列表...
2025-06-24 16:19:29,125 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:19:29,125 INFO sqlalchemy.engine.Engine SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] ORDER BY [Bills].[BillDate] DESC
INFO:sqlalchemy.engine.Engine:SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] ORDER BY [Bills].[BillDate] DESC
2025-06-24 16:19:29,125 INFO sqlalchemy.engine.Engine [generated in 0.00080s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00080s] ()
INFO:__main__:成功获取到 3 个订单
2025-06-24 16:19:29,133 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 16:19:29,133 INFO sqlalchemy.engine.Engine [generated in 0.00085s] (3,)
INFO:sqlalchemy.engine.Engine:[generated in 0.00085s] (3,)
2025-06-24 16:19:29,141 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 16:19:29,141 INFO sqlalchemy.engine.Engine [cached since 0.005889s ago] (2,)
INFO:sqlalchemy.engine.Engine:[cached since 0.005889s ago] (2,)
2025-06-24 16:19:29,141 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 16:19:29,141 INFO sqlalchemy.engine.Engine [cached since 0.00837s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 0.00837s ago] (1,)
INFO:     None:0 - "GET /bills HTTP/1.1" 200 OK
2025-06-24 16:19:29,146 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 16:19:30,058 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 16:19:30,058 INFO sqlalchemy.engine.Engine SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 16:19:30,058 INFO sqlalchemy.engine.Engine [generated in 0.00071s] (datetime.datetime(2025, 5, 25, 0, 0), datetime.datetime(2025, 6, 24, 23, 59, 59), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00071s] (datetime.datetime(2025, 5, 25, 0, 0), datetime.datetime(2025, 6, 24, 23, 59, 59), '已结账')
2025-06-24 16:19:30,066 INFO sqlalchemy.engine.Engine SELECT TOP 10 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales, sum([BillItems].[Price] * [BillItems].[Quantity]) AS revenue 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 10 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales, sum([BillItems].[Price] * [BillItems].[Quantity]) AS revenue 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 16:19:30,066 INFO sqlalchemy.engine.Engine [generated in 0.00089s] (datetime.datetime(2025, 5, 25, 0, 0), datetime.datetime(2025, 6, 24, 23, 59, 59), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00089s] (datetime.datetime(2025, 5, 25, 0, 0), datetime.datetime(2025, 6, 24, 23, 59, 59), '已结账')
INFO:     None:0 - "GET /report/sales?start=2025-05-25&end=2025-06-24&unit=day HTTP/1.1" 200 OK
2025-06-24 16:19:30,075 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [66856]
