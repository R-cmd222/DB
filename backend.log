C:\Users\sdjf\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:318: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [58544]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9527 (Press CTRL+C to quit)
INFO:     None:0 - "GET /health HTTP/1.1" 200 OK
2025-06-24 22:40:25,519 INFO sqlalchemy.engine.Engine SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
INFO:sqlalchemy.engine.Engine:SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-24 22:40:25,519 INFO sqlalchemy.engine.Engine [raw sql] ()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
2025-06-24 22:40:25,521 INFO sqlalchemy.engine.Engine SELECT schema_name()
INFO:sqlalchemy.engine.Engine:SELECT schema_name()
2025-06-24 22:40:25,521 INFO sqlalchemy.engine.Engine [generated in 0.00040s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00040s] ()
2025-06-24 22:40:25,551 INFO sqlalchemy.engine.Engine SELECT CAST('test max support' AS NVARCHAR(max))
INFO:sqlalchemy.engine.Engine:SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-24 22:40:25,551 INFO sqlalchemy.engine.Engine [generated in 0.00041s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00041s] ()
2025-06-24 22:40:25,552 INFO sqlalchemy.engine.Engine SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
INFO:sqlalchemy.engine.Engine:SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-24 22:40:25,552 INFO sqlalchemy.engine.Engine [generated in 0.00032s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00032s] ()
2025-06-24 22:40:25,635 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 22:40:25,640 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[Category] AS [Products_Category] 
FROM [Products]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[Category] AS [Products_Category] 
FROM [Products]) AS anon_1
2025-06-24 22:40:25,640 INFO sqlalchemy.engine.Engine [generated in 0.00053s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00053s] ()
2025-06-24 22:40:25,640 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
2025-06-24 22:40:25,640 INFO sqlalchemy.engine.Engine [generated in 0.00036s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00036s] ()
2025-06-24 22:40:25,640 INFO sqlalchemy.engine.Engine SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
2025-06-24 22:40:25,648 INFO sqlalchemy.engine.Engine [generated in 0.00031s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00031s] ()
2025-06-24 22:40:25,651 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[Category] AS [Products_Category] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[Category] AS [Products_Category] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
2025-06-24 22:40:25,651 INFO sqlalchemy.engine.Engine [generated in 0.00037s] (10,)
INFO:sqlalchemy.engine.Engine:[generated in 0.00037s] (10,)
INFO:     None:0 - "GET /stats HTTP/1.1" 200 OK
2025-06-24 22:40:25,654 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 22:40:25,967 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 22:40:25,969 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 22:40:25,969 INFO sqlalchemy.engine.Engine [generated in 0.00057s] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00057s] (datetime.datetime(2025, 6, 24, 0, 0), '已结账')
2025-06-24 22:40:25,971 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 22:40:25,971 INFO sqlalchemy.engine.Engine [cached since 0.0026s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 0.0026s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已结账')
2025-06-24 22:40:25,973 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 22:40:25,973 INFO sqlalchemy.engine.Engine [generated in 0.00036s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
INFO:sqlalchemy.engine.Engine:[generated in 0.00036s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已结账')
2025-06-24 22:40:25,973 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 22:40:25,973 INFO sqlalchemy.engine.Engine [cached since 0.006293s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:sqlalchemy.engine.Engine:[cached since 0.006293s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已结账')
INFO:     None:0 - "GET /dashboard/sales HTTP/1.1" 200 OK
2025-06-24 22:40:25,973 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 22:40:26,221 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 22:40:26,223 INFO sqlalchemy.engine.Engine SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 22:40:26,223 INFO sqlalchemy.engine.Engine [generated in 0.00050s] ('已结账',)
INFO:sqlalchemy.engine.Engine:[generated in 0.00050s] ('已结账',)
INFO:     None:0 - "GET /dashboard/top-products?limit=5 HTTP/1.1" 200 OK
2025-06-24 22:40:26,227 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [58544]
