C:\Users\sdjf\AppData\Local\Programs\Python\Python312\Lib\site-packages\pydantic\_internal\_config.py:318: UserWarning: Valid config keys have changed in V2:
* 'orm_mode' has been renamed to 'from_attributes'
  warnings.warn(message, UserWarning)
INFO:     Started server process [54080]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:9527 (Press CTRL+C to quit)
INFO:     None:0 - "GET /health HTTP/1.1" 200 OK
2025-06-24 14:17:54,682 INFO sqlalchemy.engine.Engine SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
INFO:sqlalchemy.engine.Engine:SELECT CAST(SERVERPROPERTY('ProductVersion') AS VARCHAR)
2025-06-24 14:17:54,682 INFO sqlalchemy.engine.Engine [raw sql] ()
INFO:sqlalchemy.engine.Engine:[raw sql] ()
2025-06-24 14:17:54,682 INFO sqlalchemy.engine.Engine SELECT schema_name()
INFO:sqlalchemy.engine.Engine:SELECT schema_name()
2025-06-24 14:17:54,682 INFO sqlalchemy.engine.Engine [generated in 0.00049s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00049s] ()
2025-06-24 14:17:54,820 INFO sqlalchemy.engine.Engine SELECT CAST('test max support' AS NVARCHAR(max))
INFO:sqlalchemy.engine.Engine:SELECT CAST('test max support' AS NVARCHAR(max))
2025-06-24 14:17:54,820 INFO sqlalchemy.engine.Engine [generated in 0.00060s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00060s] ()
2025-06-24 14:17:54,820 INFO sqlalchemy.engine.Engine SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
INFO:sqlalchemy.engine.Engine:SELECT 1 FROM fn_listextendedproperty(default, default, default, default, default, default, default)
2025-06-24 14:17:54,820 INFO sqlalchemy.engine.Engine [generated in 0.00059s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00059s] ()
2025-06-24 14:17:54,878 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:17:54,878 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
2025-06-24 14:17:54,878 INFO sqlalchemy.engine.Engine [generated in 0.00054s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00054s] ()
2025-06-24 14:17:54,907 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
2025-06-24 14:17:54,911 INFO sqlalchemy.engine.Engine [generated in 0.00056s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00056s] ()
2025-06-24 14:17:54,916 INFO sqlalchemy.engine.Engine SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
2025-06-24 14:17:54,916 INFO sqlalchemy.engine.Engine [generated in 0.00055s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00055s] ()
2025-06-24 14:17:54,925 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
2025-06-24 14:17:54,925 INFO sqlalchemy.engine.Engine [generated in 0.00058s] (10,)
INFO:sqlalchemy.engine.Engine:[generated in 0.00058s] (10,)
INFO:     None:0 - "GET /stats HTTP/1.1" 200 OK
2025-06-24 14:17:54,932 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:17:54,945 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:17:54,945 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:17:54,945 INFO sqlalchemy.engine.Engine [generated in 0.00049s] (datetime.datetime(2025, 6, 24, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[generated in 0.00049s] (datetime.datetime(2025, 6, 24, 0, 0), '已完成')
2025-06-24 14:17:54,949 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:17:54,949 INFO sqlalchemy.engine.Engine [cached since 0.01288s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 0.01288s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已完成')
2025-06-24 14:17:54,961 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 14:17:54,961 INFO sqlalchemy.engine.Engine [generated in 0.00054s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已完成')
INFO:sqlalchemy.engine.Engine:[generated in 0.00054s] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已完成')
2025-06-24 14:17:54,961 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:17:54,966 INFO sqlalchemy.engine.Engine [cached since 0.01873s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 0.01873s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已完成')
INFO:     None:0 - "GET /dashboard/sales HTTP/1.1" 200 OK
2025-06-24 14:17:54,966 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:17:55,291 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:17:55,291 INFO sqlalchemy.engine.Engine SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 14:17:55,291 INFO sqlalchemy.engine.Engine [generated in 0.00063s] ('已完成',)
INFO:sqlalchemy.engine.Engine:[generated in 0.00063s] ('已完成',)
INFO:     None:0 - "GET /dashboard/top-products?limit=5 HTTP/1.1" 200 OK
2025-06-24 14:17:55,386 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:00,253 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:00,254 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:00,254 INFO sqlalchemy.engine.Engine [generated in 0.00079s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00079s] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:00,261 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:01,896 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:01,899 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:01,899 INFO sqlalchemy.engine.Engine [cached since 1.645s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 1.645s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:01,903 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:02,646 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:02,646 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:02,646 INFO sqlalchemy.engine.Engine [cached since 2.394s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 2.394s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:02,649 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:__main__:正在获取订单列表...
2025-06-24 14:18:03,474 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:03,478 INFO sqlalchemy.engine.Engine SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] ORDER BY [Bills].[BillDate] DESC
INFO:sqlalchemy.engine.Engine:SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills] ORDER BY [Bills].[BillDate] DESC
2025-06-24 14:18:03,478 INFO sqlalchemy.engine.Engine [generated in 0.00064s] ()
INFO:sqlalchemy.engine.Engine:[generated in 0.00064s] ()
INFO:__main__:成功获取到 3 个订单
2025-06-24 14:18:03,483 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 14:18:03,483 INFO sqlalchemy.engine.Engine [generated in 0.00063s] (3,)
INFO:sqlalchemy.engine.Engine:[generated in 0.00063s] (3,)
2025-06-24 14:18:03,487 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 14:18:03,487 INFO sqlalchemy.engine.Engine [cached since 0.004255s ago] (2,)
INFO:sqlalchemy.engine.Engine:[cached since 0.004255s ago] (2,)
2025-06-24 14:18:03,491 INFO sqlalchemy.engine.Engine SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
INFO:sqlalchemy.engine.Engine:SELECT [BillItems].[BillItemID] AS [BillItems_BillItemID], [BillItems].[BillID] AS [BillItems_BillID], [BillItems].[ProductID] AS [BillItems_ProductID], [BillItems].[Quantity] AS [BillItems_Quantity], [BillItems].[Price] AS [BillItems_Price] 
FROM [BillItems] 
WHERE [BillItems].[BillID] = ?
2025-06-24 14:18:03,491 INFO sqlalchemy.engine.Engine [cached since 0.006621s ago] (1,)
INFO:sqlalchemy.engine.Engine:[cached since 0.006621s ago] (1,)
INFO:     None:0 - "GET /bills HTTP/1.1" 200 OK
2025-06-24 14:18:03,495 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:12,422 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:12,422 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:12,424 INFO sqlalchemy.engine.Engine [cached since 12.17s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 12.17s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:12,428 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:13,686 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:13,687 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:13,687 INFO sqlalchemy.engine.Engine [cached since 13.43s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 13.43s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:13,691 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:13,938 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:13,938 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:13,941 INFO sqlalchemy.engine.Engine [cached since 13.69s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 13.69s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:13,945 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:14,204 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:14,204 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:14,204 INFO sqlalchemy.engine.Engine [cached since 13.95s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 13.95s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:14,208 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:15,929 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:15,929 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:15,929 INFO sqlalchemy.engine.Engine [cached since 15.68s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 15.68s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:15,933 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:     None:0 - "GET /health HTTP/1.1" 200 OK
2025-06-24 14:18:16,670 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:16,675 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]) AS anon_1
2025-06-24 14:18:16,675 INFO sqlalchemy.engine.Engine [cached since 21.79s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 21.79s ago] ()
2025-06-24 14:18:16,675 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Bills].[BillID] AS [Bills_BillID], [Bills].[TotalAmount] AS [Bills_TotalAmount], [Bills].[Status] AS [Bills_Status], [Bills].[PaymentMethod] AS [Bills_PaymentMethod], [Bills].[BillDate] AS [Bills_BillDate], [Bills].[EmployeeID] AS [Bills_EmployeeID], [Bills].[GuestID] AS [Bills_GuestID] 
FROM [Bills]) AS anon_1
2025-06-24 14:18:16,675 INFO sqlalchemy.engine.Engine [cached since 21.77s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 21.77s ago] ()
2025-06-24 14:18:16,679 INFO sqlalchemy.engine.Engine SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT sum([Products].[Stock]) AS sum_1 
FROM [Products]
2025-06-24 14:18:16,679 INFO sqlalchemy.engine.Engine [cached since 21.76s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 21.76s ago] ()
2025-06-24 14:18:16,679 INFO sqlalchemy.engine.Engine SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
INFO:sqlalchemy.engine.Engine:SELECT count(*) AS count_1 
FROM (SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products] 
WHERE [Products].[Stock] < ?) AS anon_1
2025-06-24 14:18:16,679 INFO sqlalchemy.engine.Engine [cached since 21.75s ago] (10,)
INFO:sqlalchemy.engine.Engine:[cached since 21.75s ago] (10,)
INFO:     None:0 - "GET /stats HTTP/1.1" 200 OK
2025-06-24 14:18:16,683 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:16,921 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:16,921 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:18:16,925 INFO sqlalchemy.engine.Engine [cached since 21.98s ago] (datetime.datetime(2025, 6, 24, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 21.98s ago] (datetime.datetime(2025, 6, 24, 0, 0), '已完成')
2025-06-24 14:18:16,926 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:18:16,926 INFO sqlalchemy.engine.Engine [cached since 21.98s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 21.98s ago] (datetime.datetime(2025, 6, 23, 0, 0), '已完成')
2025-06-24 14:18:16,929 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[BillDate] <= ? AND [Bills].[Status] = ?
2025-06-24 14:18:16,929 INFO sqlalchemy.engine.Engine [cached since 21.97s ago] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 21.97s ago] (datetime.datetime(2025, 6, 16, 0, 0), datetime.datetime(2025, 6, 22, 23, 59, 59), '已完成')
2025-06-24 14:18:16,929 INFO sqlalchemy.engine.Engine SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
INFO:sqlalchemy.engine.Engine:SELECT sum([Bills].[TotalAmount]) AS sum_1 
FROM [Bills] 
WHERE [Bills].[BillDate] >= ? AND [Bills].[Status] = ?
2025-06-24 14:18:16,929 INFO sqlalchemy.engine.Engine [cached since 21.98s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已完成')
INFO:sqlalchemy.engine.Engine:[cached since 21.98s ago] (datetime.datetime(2025, 6, 1, 0, 0), '已完成')
INFO:     None:0 - "GET /dashboard/sales HTTP/1.1" 200 OK
2025-06-24 14:18:16,933 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:17,004 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:17,004 INFO sqlalchemy.engine.Engine SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
INFO:sqlalchemy.engine.Engine:SELECT TOP 5 [Products].[Name] AS [Products_Name], sum([BillItems].[Quantity]) AS sales 
FROM [Products] JOIN [BillItems] ON [BillItems].[ProductID] = [Products].[ProductID] JOIN [Bills] ON [Bills].[BillID] = [BillItems].[BillID] 
WHERE [Bills].[Status] = ? GROUP BY [Products].[Name] ORDER BY sum([BillItems].[Quantity]) DESC
2025-06-24 14:18:17,004 INFO sqlalchemy.engine.Engine [cached since 21.71s ago] ('已完成',)
INFO:sqlalchemy.engine.Engine:[cached since 21.71s ago] ('已完成',)
INFO:     None:0 - "GET /dashboard/top-products?limit=5 HTTP/1.1" 200 OK
2025-06-24 14:18:17,008 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:23,372 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:23,374 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:23,374 INFO sqlalchemy.engine.Engine [cached since 23.12s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 23.12s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:23,379 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:24,695 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:24,696 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:24,696 INFO sqlalchemy.engine.Engine [cached since 24.44s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 24.44s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:24,700 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
2025-06-24 14:18:24,946 INFO sqlalchemy.engine.Engine BEGIN (implicit)
INFO:sqlalchemy.engine.Engine:BEGIN (implicit)
2025-06-24 14:18:24,946 INFO sqlalchemy.engine.Engine SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
INFO:sqlalchemy.engine.Engine:SELECT [Products].[ProductID] AS [Products_ProductID], [Products].[Name] AS [Products_Name], [Products].[Price] AS [Products_Price], [Products].[Stock] AS [Products_Stock], [Products].[Unit] AS [Products_Unit], [Products].[LastInDate] AS [Products_LastInDate], [Products].[CategoryID] AS [Products_CategoryID] 
FROM [Products]
2025-06-24 14:18:24,946 INFO sqlalchemy.engine.Engine [cached since 24.69s ago] ()
INFO:sqlalchemy.engine.Engine:[cached since 24.69s ago] ()
INFO:     None:0 - "GET /products HTTP/1.1" 200 OK
2025-06-24 14:18:24,954 INFO sqlalchemy.engine.Engine ROLLBACK
INFO:sqlalchemy.engine.Engine:ROLLBACK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [54080]
